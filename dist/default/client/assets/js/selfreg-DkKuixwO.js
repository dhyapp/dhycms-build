import{_ as y}from"./index--QGmuNsI.js";import{d as F}from"./index-EJK1-8dv.js";import{u as z,d as L}from"./coms-BGBaUFfq.js";import{bU as h,bD as j,bT as A,aA as B,bV as H,bG as J}from"./ant1-FgANxHEo.js";import{e as N,F as r,A as O,j as P,I as W,f as X}from"./ant2-F-VMf9eP.js";import{f as u,r as $,c as Y,w as Z,o as Q,V as m,W as ee,k as l,$ as t,u as a,X as d,Z as _,a2 as V,G as b,J as I}from"./vue-DoSrNxHp.js";import"./modal-DZ8O4vOv.js";import"./main-CiTClfZk.js";import"./index-DoS9QrfY.js";const ae={class:"pannel selfreg-contact-page"},le={class:"setting-max-800 pt20 pr20 pb30 pl30"},te={class:"setting-max-800 pt20 pr20 pb30 pl30"},oe=d("ul",{class:"pl14",style:{"list-style":"decimal"}},[d("li",null,[d("b",null,"跳转域名（强烈推荐填写，可提高站点存活率）"),b("，随机使用以下域名生成友链。默认使用本域名做为跳转域名（不推荐）。")]),d("li",null,[d("b",null,"收录最低来源"),b("需安装并"),d("b",null,"开启自动收录插件"),b("后方可生效。")])],-1),se={class:"mt4"},ne=["href"],ge={__name:"selfreg",setup(re){const S=z(),D=L(),w=u("selfreg-base"),f={label:6,wrapper:24},G=u(null),n=$({about:"",cooperation:"",contact:"",description:""}),i=$({baseReferrerCount:0,name:"",domains:""}),c=Y(()=>S.theme==="dark"),U=u(null),x=u(null),K=u(null),M=u(null),v={inline:!0},p=u(!1),g=u(!1),C=u(!1),k={"selfreg-base":n,"selfreg-in":i},T=async s=>{try{C.value=!0,await F.get({query:{fieldby:"key",field:s}}).then(e=>{if(e!=null&&e.value){const o=I(k[s]);for(const R in o)k[s][R]=e.value[R]||k[s][R]}p.value=!0})}finally{C.value=!1}},E=async s=>{try{g.value=!0,await F.update({query:{fieldby:"key",field:s},body:{value:I(k[s]),key:s,_upsert:!0}}).then(()=>{J.success("保存成功")})}finally{g.value=!1}};Z(()=>S.theme,()=>{U.value.reload(),x.value.reload()});const q=s=>{T(s||w.value)};return Q(()=>{T("selfreg-base")}),(s,e)=>(m(),ee("div",ae,[l(a(H),{activeKey:w.value,"onUpdate:activeKey":e[9]||(e[9]=o=>w.value=o),onChange:q},{default:t(()=>[l(a(h),{key:"selfreg-base",tab:"联系与说明"},{default:t(()=>[d("div",le,[l(a(j),{spinning:C.value},{default:t(()=>[l(a(N),{ref_key:"formRef",ref:G,model:n,labelAlign:"left","label-col":{span:f.label}},{default:t(()=>[l(a(r),{label:"关于我们"},{default:t(()=>[p.value?(m(),_(y,{key:0,ref_key:"editorRef",ref:U,id:"aboutEditor",modelValue:n.about,"onUpdate:modelValue":e[0]||(e[0]=o=>n.about=o),dark:c.value,options:v},null,8,["modelValue","dark"])):V("",!0)]),_:1}),l(a(r),{label:"广告合作"},{default:t(()=>[p.value?(m(),_(y,{key:0,ref_key:"editor2Ref",ref:x,id:"cooperateEditor",modelValue:n.cooperation,"onUpdate:modelValue":e[1]||(e[1]=o=>n.cooperation=o),dark:c.value,options:v},null,8,["modelValue","dark"])):V("",!0)]),_:1}),l(a(r),{label:"联系我们"},{default:t(()=>[p.value?(m(),_(y,{key:0,ref_key:"editor3Ref",ref:K,id:"contactEditor",modelValue:n.contact,"onUpdate:modelValue":e[2]||(e[2]=o=>n.contact=o),dark:c.value,options:v},null,8,["modelValue","dark"])):V("",!0)]),_:1}),l(a(r),{label:"收录说明"},{default:t(()=>[p.value?(m(),_(y,{key:0,ref_key:"editor4Ref",ref:M,id:"decriptionEditor",modelValue:n.description,"onUpdate:modelValue":e[3]||(e[3]=o=>n.description=o),dark:c.value,options:v},null,8,["modelValue","dark"])):V("",!0)]),_:1}),l(a(r),{wrapperCol:{offset:f.label}},{default:t(()=>[l(a(A),{size:"middle"},{default:t(()=>[l(a(B),{type:"primary",loading:g.value,onClick:e[4]||(e[4]=o=>E("selfreg-base"))},{default:t(()=>[b("保存")]),_:1},8,["loading"])]),_:1})]),_:1},8,["wrapperCol"])]),_:1},8,["model","label-col"])]),_:1},8,["spinning"])])]),_:1}),l(a(h),{key:"selfreg-in",tab:"收录设置"},{default:t(()=>[d("div",te,[l(a(N),{model:i,labelAlign:"left","label-col":{span:f.label}},{default:t(()=>[l(a(r),{wrapperCol:{offset:f.label}},{default:t(()=>[l(a(O),{class:"mb10",type:"warning"},{message:t(()=>[oe]),_:1})]),_:1},8,["wrapperCol"]),l(a(r),{label:"友链跳转域名"},{default:t(()=>[l(a(P),{value:i.domains,"onUpdate:value":e[5]||(e[5]=o=>i.domains=o),rows:6,placeholder:"https://开头，多个域名请换行"},null,8,["value"]),d("div",se,[d("a",{href:`${a(D).config.dhy.gateway}/market?type=landing`,target:"_blank",class:"txt-info"},"免费获取DHYCMS跳转页模板",8,ne)])]),_:1}),l(a(r),{label:"己站名称"},{default:t(()=>[l(a(W),{value:i.name,"onUpdate:value":e[6]||(e[6]=o=>i.name=o),placeholder:"提示对方进行收录的我站名称，默认使用网站简称"},null,8,["value"])]),_:1}),l(a(r),{label:"收录最低来源"},{default:t(()=>[l(a(X),{value:i.baseReferrerCount,"onUpdate:value":e[7]||(e[7]=o=>i.baseReferrerCount=o),placeholder:"请收入最低收录来源量",min:0},null,8,["value"])]),_:1}),l(a(r),{wrapperCol:{offset:f.label}},{default:t(()=>[l(a(A),{size:"middle"},{default:t(()=>[l(a(B),{type:"primary",loading:g.value,onClick:e[8]||(e[8]=o=>E("selfreg-in"))},{default:t(()=>[b("保存")]),_:1},8,["loading"])]),_:1})]),_:1},8,["wrapperCol"])]),_:1},8,["model","label-col"])])]),_:1})]),_:1},8,["activeKey"])]))}};export{ge as default};
