import{r as j,q,u as E,f as v}from"./coms-BJ4SXf9r.js";import{g as F}from"./post-Di1DEtgy.js";import{c as m,a6 as D,V as a,W as n,X as o,k as h,ab as $,a4 as I,f as R,o as G,y as A,n as L,u as p,Y as r,F as g,a7 as k,a2 as _,a1 as c,G as S,m as z,Z as X,$ as Y}from"./vue-DoSrNxHp.js";import{L as P}from"./loading-BEvWhuYv.js";import"./ant2-F-VMf9eP.js";import"./ant1-FgANxHEo.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const Z=(y={},f={})=>j(`/api/v1/moduledata?${q(y)}`,f),H=(y={})=>j(`/api/v1/navs?${q(y)}`),J={class:"dhy-tiny-pagination"},U={__name:"tinyPagination",props:{current:{type:Number,default:1},pageSize:{type:Number,default:20},total:{type:Number,default:0}},emits:["change","update:current"],setup(y,{emit:f}){const s=y,i=f,b=m(()=>Math.ceil(s.total/s.pageSize)),M=m(()=>b.value===0||s.current===1),N=m(()=>b.value===0||s.current===b.value),x=()=>{const u=s.current-1;i("update:current",u),i("change",u)},T=()=>{const u=s.current+1;i("update:current",u),i("change",u)};return(u,l)=>{const d=D("MIcon");return a(),n("div",J,[o("div",{class:$(["left",{disabled:M.value}]),title:"上一页",onClick:x},[h(d,{name:"left"})],2),o("div",{class:$(["right",{disabled:N.value}]),title:"下一页",onClick:T},[h(d,{name:"right"})],2)])}}},K={class:"home-page"},O=["href"],Q=["href"],ee=["id"],te={class:"f fw module-app"},ae=["href"],ne={class:"img-box"},se={key:0,class:"mask"},oe=["id"],le={class:"f fw module-nav"},re=["href"],ce={key:0,class:"mask"},ue=["id"],ie={class:"f fw module-post"},de={class:"txt-ellipsis-1"},pe={key:0,class:"mask"},_e={key:3,class:"module-ad"},ge=["href"],he=["alt"],Se={__name:"index",setup(y){const f=I(),s=E(),i=m(()=>s.appearance.themeLight),b=m(()=>Math.round(100/(s.appearance.pccols||10)*1e6)/1e6),M=m(()=>Math.round(100/(s.appearance.pccolsPost||2)*1e6)/1e6),N=m(()=>Math.round(100/(s.appearance.appcols||12)*1e6)/1e6),x=R([]),T=m(()=>s.menu),u=async(l,d)=>{const w={nav:H,post:F};try{l.loading=!0,await w[d]({current:l.current,pageSize:l.pageSize,mid:l._id}).then(C=>{l.data=C.result||[],l.total=C.total})}finally{l.loading=!1}};return G(()=>{Z().then(l=>{x.value=l||[],s.menu=(l==null?void 0:l.filter(d=>["nav","link","post","app"].includes(d.subType)))||[],A(()=>{if(f.hash){const d=document.getElementById(f.hash.slice(1));window.scrollTo(0,d.offsetTop)}})})}),(l,d)=>{const w=D("RouterLink"),C=L("depic"),B=L("navexpos"),V=L("navclick");return a(),n("div",K,[p(s).isMobile?_("",!0):(a(),n("nav",{key:0,class:"nav f fw",style:r({backgroundColor:i.value})},[(a(!0),n(g,null,k(T.value,e=>(a(),n("div",{key:e._id,style:r({color:e.color})},[e.subType==="link"?(a(),n("a",{key:0,href:e.link,target:"_blank"},c(e.name),9,O)):(a(),n("a",{key:1,href:`#${p(v)(e.name)}`},c(e.name),9,Q))],4))),128))],4)),(a(!0),n(g,null,k(x.value,e=>{var W;return a(),n(g,{key:e._id},[(W=e.data)!=null&&W.length?(a(),n(g,{key:0},[e.subType==="app"?(a(),n("div",{key:0,id:p(v)(e.name)},[o("div",{class:"module-title f jb ac",style:r({backgroundColor:i.value})},[S(c(e.name)+" ",1),h(U,{current:e.current,"onUpdate:current":t=>e.current=t,pageSize:e.pageSize,total:e.total,onChange:t=>u(e,"nav")},null,8,["current","onUpdate:current","pageSize","total","onChange"])],4),o("div",te,[(a(!0),n(g,null,k(e.data,t=>z((a(),n("a",{class:$(["item",[`item-mcol-${p(s).appearance.mappcols||5}`]]),href:t.link,target:"_blank",style:r(`${t.styles};flex:0 0 ${N.value}%`)},[o("div",ne,[z(o("img",null,null,512),[[C,t.logo]])]),o("span",null,[S(c(t.name)+" ",1),t.tag?(a(),n("label",{key:0,style:r(t.tagStyles)},c(t.tag),5)):_("",!0)])],14,ae)),[[B,t.referrerCode],[V,t.referrerCode]])),256)),e.loading?(a(),n("div",se,[h(P)])):_("",!0)])],8,ee)):e.subType==="nav"?(a(),n("div",{key:1,id:p(v)(e.name)},[o("div",{class:"module-title f jb ac",style:r({backgroundColor:i.value})},[S(c(e.name)+" ",1),h(U,{current:e.current,"onUpdate:current":t=>e.current=t,pageSize:e.pageSize,total:e.total,onChange:t=>u(e,"nav")},null,8,["current","onUpdate:current","pageSize","total","onChange"])],4),o("div",le,[(a(!0),n(g,null,k(e.data,t=>z((a(),n("a",{class:$(["item",[`item-mcol-${p(s).appearance.mcols||4}`]]),href:t.link,target:"_blank",style:r(`${t.styles};flex:0 0 ${b.value}%`)},[o("span",null,[S(c(t.name)+" ",1),t.tag?(a(),n("label",{key:0,style:r(t.tagStyles)},c(t.tag),5)):_("",!0)])],14,re)),[[B,t.referrerCode],[V,t.referrerCode]])),256)),e.loading?(a(),n("div",ce,[h(P)])):_("",!0)])],8,oe)):e.subType==="post"?(a(),n("div",{key:2,id:p(v)(e.name)},[o("div",{class:"module-title f jb ac",style:r({backgroundColor:i.value})},[S(c(e.name)+" ",1),h(U,{current:e.current,"onUpdate:current":t=>e.current=t,pageSize:e.pageSize,total:e.total,onChange:t=>u(e,"post")},null,8,["current","onUpdate:current","pageSize","total","onChange"])],4),o("div",ie,[(a(!0),n(g,null,k(e.data,t=>(a(),X(w,{class:$(["item",[`item-mcol-${p(s).appearance.mcolsPost||1}`]]),to:`/post/${t.id}?cname=${p(v)(e.name)}`,style:r(`${t.styles};flex:0 0 ${M.value}%`)},{default:Y(()=>[o("span",null,[o("span",de,c(t.title),1),t.tag?(a(),n("label",{key:0,style:r(t.tagStyles)},c(t.tag),5)):_("",!0)])]),_:2},1032,["class","to","style"]))),256)),e.loading?(a(),n("div",pe,[h(P)])):_("",!0)])],8,ue)):e.subType==="ad"?(a(),n("div",_e,[(a(!0),n(g,null,k(e.data,t=>(a(),n("a",{href:t.link,target:"_blank",class:"item"},[z(o("img",{alt:t.name},null,8,he),[[C,t.imgurl]])],8,ge))),256))])):_("",!0)],64)):_("",!0)],64)}),128))])}}};export{Se as default};
