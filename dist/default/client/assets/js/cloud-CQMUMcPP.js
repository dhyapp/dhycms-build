import{d as h}from"./index-fks0TXNb.js";import{u as I,p as q}from"./coms-BJ4SXf9r.js";import{bU as S,bD as U,aA as k,bT as B,bV as F,bG as w}from"./ant1-FgANxHEo.js";import{e as G,F as d,I as p,A as m,j as M,p as V,d as A,P as K}from"./ant2-F-VMf9eP.js";import{f as g,r as N,o as P,V as $,W as L,k as l,$ as o,u as t,X as r,G as T,J as C}from"./vue-DoSrNxHp.js";const j={class:"pannel setting-cloud-page"},z={class:"setting-max-800 pt20 pr20 pb30 pl30"},E=r("div",{class:"mt4"},[r("a",{href:"https://t.me/botfather",target:"_blank",class:"txt-info"},"点我获取 Telegram Bot Token")],-1),J=r("div",{class:"mt4"},[r("a",{href:"https://t.me/userinfobot",target:"_blank",class:"txt-info"},"点我获取 Telegram Chat ID")],-1),R=r("div",{class:"mt4"},[r("a",{href:"/post/cloudflare-static-domains",target:"_blank",class:"txt-info"},"CloudFlare 静态域名部署帮助文档")],-1),W=r("hr",{class:"mb30"},null,-1),X={class:"f ac"},H=r("b",{class:"ml8"},"加密后无法直接预览或打开云盘图片/文件，需进行解密操作",-1),ae={__name:"cloud",setup(O){const b=I(),v=g("cloud"),y={label:6,wrapper:24},a=N({type:"local",tgToken:"",tgChatID:"",staticDomains:"",encoded:!1,secret:""}),u=g(!1),c=g(!1),i={cloud:a},_=async n=>{try{c.value=!0,await h.get({query:{fieldby:"key",field:n}}).then(e=>{if(e!=null&&e.value){const s=C(i[n]);for(const f in s)i[n][f]=e.value[f]||i[n][f]}})}finally{c.value=!1}},D=async n=>{if(a.secret&&!/^\w{16}$/.test(a.secret))return w.error("密匙格式错误");try{u.value=!0,await h.update({query:{fieldby:"key",field:n},body:{value:C(i[n]),key:n,_upsert:!0}}).then(()=>{if(w.success("保存成功"),n==="cloud"){const e=a.staticDomains.split(`
`),s=Math.floor(Math.random()*e.length);b.cloud={...b.cloud,encoded:a.encoded,key:a.secret,staticDomain:e[s]}}})}finally{u.value=!1}},x=n=>{_(n)};return P(()=>{_("cloud")}),(n,e)=>($(),L("div",j,[l(t(F),{activeKey:v.value,"onUpdate:activeKey":e[7]||(e[7]=s=>v.value=s),onChange:x},{default:o(()=>[l(t(S),{key:"cloud",tab:"TG云盘"},{default:o(()=>[r("div",z,[l(t(U),{spinning:c.value},{default:o(()=>[l(t(G),{model:a,labelAlign:"left","label-col":{span:y.label}},{default:o(()=>[l(t(d),{label:"Telegram Bot Token",required:a.type==="tg"||a.type==="tgcf"},{default:o(()=>[l(t(p),{value:a.tgToken,"onUpdate:value":e[0]||(e[0]=s=>a.tgToken=s),type:"password"},null,8,["value"]),E]),_:1},8,["required"]),l(t(d),{label:"Telegram Chat ID",required:a.type==="tg"||a.type==="tgcf"},{default:o(()=>[l(t(p),{value:a.tgChatID,"onUpdate:value":e[1]||(e[1]=s=>a.tgChatID=s)},null,8,["value"]),J,l(t(m),{message:"该 Chat ID 用户需与机器人发生首次交互，如发送 /start，否则无法生效",type:"warning","show-icon":"",banner:"",class:"mt10"})]),_:1},8,["required"]),l(t(d),{label:"CloudFlare 静态域名",required:a.type==="tgcf"},{default:o(()=>[l(t(M),{value:a.staticDomains,"onUpdate:value":e[2]||(e[2]=s=>a.staticDomains=s),rows:6,placeholder:"https://开头，多个域名请换行"},null,8,["value"]),R]),_:1},8,["required"]),W,l(t(d),{label:"是否加密"},{default:o(()=>[r("div",X,[l(t(V),{checked:a.encoded,"onUpdate:checked":e[3]||(e[3]=s=>a.encoded=s)},null,8,["checked"]),H])]),_:1}),l(t(d),{label:"密匙"},{default:o(()=>[l(t(A),{compact:""},{default:o(()=>[l(t(p),{value:a.secret,"onUpdate:value":e[4]||(e[4]=s=>a.secret=s),style:{width:"calc(100% - 120px)"}},null,8,["value"]),l(t(K),{title:"确认生成？",description:"原密匙覆盖后，旧文件将会失效，请谨慎操作！",onConfirm:e[5]||(e[5]=()=>a.secret=t(q)(16))},{default:o(()=>[l(t(k),{type:"primary"},{default:o(()=>[T("点击生成密匙")]),_:1})]),_:1})]),_:1}),l(t(m),{message:"仅支持英文+数字16位字符",type:"warning","show-icon":"",banner:"",class:"mt10"}),l(t(m),{message:"请自行保存密匙，且勿轻易修改，否则将会造成之前上传的云盘图片/文件无法解密",type:"warning","show-icon":"",banner:"",class:"mt10"})]),_:1}),l(t(d),{wrapperCol:{offset:y.label}},{default:o(()=>[l(t(B),{size:"middle"},{default:o(()=>[l(t(k),{type:"primary",loading:u.value,onClick:e[6]||(e[6]=s=>D("cloud"))},{default:o(()=>[T("保存")]),_:1},8,["loading"])]),_:1})]),_:1},8,["wrapperCol"])]),_:1},8,["model","label-col"])]),_:1},8,["spinning"])])]),_:1})]),_:1},8,["activeKey"])]))}};export{ae as default};
