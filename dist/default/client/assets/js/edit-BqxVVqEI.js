import{_ as h}from"./admin-form-action-bar-CaxKRg0f.js";import{s as q,m as A}from"./index-EJK1-8dv.js";import{a4 as D,ae as T,c as O,f as m,r as z,o as E,a6 as I,W as k,k as e,$ as l,u as a,X as c,F as g,J as U,V as p,G as d,a1 as y,a7 as x,Z as J}from"./vue-DoSrNxHp.js";import{u as P,t as Q}from"./coms-BGBaUFfq.js";import{bP as w,bQ as W,aA as X,bN as Z,bO as j,bD as H,bG as K}from"./ant1-FgANxHEo.js";import{e as Y,F as i,I as f,s as ee,t as ae}from"./ant2-F-VMf9eP.js";const te={class:"f ac"},le={class:"pannel nav-edit-page"},se=c("div",{class:"phead"},"收录编辑",-1),re={class:"form-max pt20 pr20 pb30 pl30"},fe={__name:"edit",setup(ne){const o=D(),F=T(),M=P(),S=O(()=>M.preadmin),R={label:4,wrapper:18},C=m(null),r=z({name:"",link:"",referrerCode:"",status:"out",mid:null,remark:""}),G={in:"已收录",out:"未收录",refuse:"驳回",block:"拉黑"},v=m(!1),_=m(!1),B=m([]),L=async n=>{try{v.value=!0,await q.get({id:n}).then(t=>{const b=U(r);for(const u in b)r[u]=t[u]||r[u]})}finally{v.value=!1}},N=async()=>{const n={sortby:"sort",fieldby:"type,subType",field:"main,nav",pageSize:1e3};await A.list({query:n}).then(t=>{B.value=Q({data:t.list})})},V=async()=>{try{_.value=!0,await C.value.validate();const n={body:U(r)};o.params.id&&(n.id=o.params.id);const t=!o.params.id;await q[t?"add":"update"](n).then(()=>{K.success(`${t?"添加":"保存"}成功`),F.back()})}finally{_.value=!1}};return E(()=>{o.params.id&&L(o.params.id),N()}),(n,t)=>{const b=I("MIcon"),u=I("RouterLink");return p(),k(g,null,[e(a(W),null,{default:l(()=>[e(a(w),null,{default:l(()=>[e(u,{to:`/${S.value}`},{default:l(()=>[e(b,{name:"dashboard",class:"mr6"}),d("控制台")]),_:1},8,["to"])]),_:1}),e(a(w),null,{default:l(()=>[e(u,{to:`/${S.value}/nav`},{default:l(()=>[d("自助收录管理")]),_:1},8,["to"])]),_:1}),e(a(w),null,{default:l(()=>[d("编辑")]),_:1})]),_:1}),e(h,{class:"mt14"},{default:l(()=>[c("div",te,[e(a(X),{type:"primary",loading:_.value,onClick:t[0]||(t[0]=s=>V())},{default:l(()=>[d(y(a(o).params.id?"保存修改":"添加"),1)]),_:1},8,["loading"])])]),_:1}),c("div",le,[se,c("div",re,[e(a(H),{spinning:v.value},{default:l(()=>[e(a(Y),{ref_key:"formRef",ref:C,model:r,labelAlign:"left","label-col":{span:R.label},"wrapper-col":{span:R.wrapper}},{default:l(()=>[e(a(i),{label:"名称",name:"name",rules:[{required:!0,message:"名称不能为空"}]},{default:l(()=>[e(a(f),{value:r.name,"onUpdate:value":t[1]||(t[1]=s=>r.name=s)},null,8,["value"])]),_:1}),e(a(i),{label:"跳转链接",name:"link",rules:[{required:!0,message:"跳转链接不能为空"}]},{default:l(()=>[e(a(f),{value:r.link,"onUpdate:value":t[2]||(t[2]=s=>r.link=s),placeholder:"https://"},null,8,["value"])]),_:1}),e(a(i),{label:"来源码",name:"referrerCode",rules:[{required:!0,message:"来源码不能为空"}]},{default:l(()=>[e(a(f),{value:r.referrerCode,"onUpdate:value":t[3]||(t[3]=s=>r.referrerCode=s)},null,8,["value"])]),_:1}),e(a(i),{label:"所属分类",name:"mid",rules:[{required:!0,message:"请选择所属分类"}]},{default:l(()=>[e(a(Z),{value:r.mid,"onUpdate:value":t[4]||(t[4]=s=>r.mid=s),placeholder:"所属菜单分类"},{default:l(()=>[(p(!0),k(g,null,x(B.value,s=>(p(),J(a(j),{key:s._id,value:s._id},{default:l(()=>[d(y(s.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),e(a(i),{label:"上下线",name:"status"},{default:l(()=>[e(a(ee),{value:r.status,"onUpdate:value":t[5]||(t[5]=s=>r.status=s)},{default:l(()=>[(p(),k(g,null,x(G,(s,$)=>e(a(ae),{key:$,value:$},{default:l(()=>[d(y(s),1)]),_:2},1032,["value"])),64))]),_:1},8,["value"])]),_:1}),e(a(i),{label:"备注",name:"remark"},{default:l(()=>[e(a(f),{value:r.remark,"onUpdate:value":t[6]||(t[6]=s=>r.remark=s),placeholder:"请输入驳回原因"},null,8,["value"])]),_:1})]),_:1},8,["model","label-col","wrapper-col"])]),_:1},8,["spinning"])])])],64)}}};export{fe as default};
