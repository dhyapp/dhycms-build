import{d as b}from"./index-fks0TXNb.js";import{g as x}from"./setting-C11UrUMU.js";import{bU as S,bD as T,bT as A,aA as F,bV as V,bG as B}from"./ant1-FgANxHEo.js";import{e as M,F as m,A as h,j as U}from"./ant2-F-VMf9eP.js";import{f as u,o as E,V as G,W as K,k as t,$ as l,u as s,X as y,G as p}from"./vue-DoSrNxHp.js";import"./coms-BJ4SXf9r.js";const N={class:"pannel setting-thirdstat-page"},q={class:"setting-max-800 pt20 pr20 pb30 pl30"},z={href:"https://developers.google.com/analytics/devguides/collection/ga4/single-page-applications?hl=zh-cn&implementation=browser-history",target:"_blank",ref:"nofollow",class:"txt-info"},X={__name:"thirdstat",setup(D){const v=u("thirdstat"),d={label:6,wrapper:24},c=u({statistics:""}),_=u({token:"",webID:"",host:""}),f=u(!1),r=u(!1),n={thirdstat:c,matomo:_},g=async e=>{try{r.value=!0,await b.get({query:{fieldby:"key",field:e}}).then(a=>{if(a!=null&&a.value){const o=n[e].value;for(const i in o)n[e].value[i]=a.value[i]??n[e].value[i]}})}finally{r.value=!1}},w=async e=>{try{f.value=!0,await b.update({query:{fieldby:"key",field:e},body:{value:n[e].value,key:e,_upsert:!0}}).then(()=>{B.success("保存成功")})}finally{f.value=!1}},k=async e=>{try{r.value=!0,await x({key:e},{error(){}}).then(a=>{if(a){const o=n[e].value;for(const i in o)n[e].value[i]=a[i]??n[e].value[i]}})}finally{r.value=!1}},C=e=>{e==="matomo"?k(e):g(e)};return E(()=>{g("thirdstat")}),(e,a)=>(G(),K("div",N,[t(s(V),{activeKey:v.value,"onUpdate:activeKey":a[2]||(a[2]=o=>v.value=o),onChange:C},{default:l(()=>[t(s(S),{key:"thirdstat",tab:"统计脚本"},{default:l(()=>[y("div",q,[t(s(T),{spinning:r.value},{default:l(()=>[t(s(M),{model:c.value,labelAlign:"left","label-col":{span:d.label}},{default:l(()=>[t(s(m),{wrapperCol:{offset:d.label}},{default:l(()=>[t(s(h),{message:"仅支持百度、谷歌、Umami、Matomo，其它第三方统计存在数据不准确的可能",type:"warning","show-icon":"",banner:""}),t(s(h),{type:"info","show-icon":"",banner:"",class:"mt10"},{message:l(()=>[p("最新的谷歌统计代码将自动统计单页应用的页面跳转，若未生效，请参考"),y("a",z,"Google Analytics（分析）-衡量单页应用",512),p("进行设置")]),_:1})]),_:1},8,["wrapperCol"]),t(s(m),{label:"统计代码",name:"statistics"},{default:l(()=>[t(s(U),{value:c.value.statistics,"onUpdate:value":a[0]||(a[0]=o=>c.value.statistics=o),style:{height:"260px"},placeholder:"请输入统计代码"},null,8,["value"])]),_:1}),t(s(m),{wrapperCol:{offset:d.label}},{default:l(()=>[t(s(A),{size:"middle"},{default:l(()=>[t(s(F),{type:"primary",loading:f.value,onClick:a[1]||(a[1]=o=>w("thirdstat"))},{default:l(()=>[p("保存")]),_:1},8,["loading"])]),_:1})]),_:1},8,["wrapperCol"])]),_:1},8,["model","label-col"])]),_:1},8,["spinning"])])]),_:1})]),_:1},8,["activeKey"])]))}};export{X as default};
