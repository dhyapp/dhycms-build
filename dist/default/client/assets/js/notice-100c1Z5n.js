import{_}from"./index--QGmuNsI.js";import{d as g}from"./index-EJK1-8dv.js";import{u as R}from"./coms-BGBaUFfq.js";import{bU as S,bD as C,bT as B,aA as P,bV as A,bG as E}from"./ant1-FgANxHEo.js";import{e as N,F as n,I as i}from"./ant2-F-VMf9eP.js";import{f as r,r as F,w as G,o as I,V as v,W as K,k as o,$ as u,u as e,X as w,Z as x,a2 as T,G as $,J as V}from"./vue-DoSrNxHp.js";import"./modal-DZ8O4vOv.js";import"./main-CiTClfZk.js";import"./index-DoS9QrfY.js";const L={class:"pannel setting-notice-page"},M={class:"setting-max-800 pt20 pr20 pb30 pl30"},z=w("hr",{class:"mb30 mt20"},null,-1),ee={__name:"notice",setup(D){const p=R(),b=r("notice"),c={label:6,wrapper:24},U=r(null),t=F({marquee:"",title:"最新公告",content:"",appurl:"",appText:"",publishurl:"",publishText:""}),d=r(!1),f=r(!1),y=r(null),k=r(null),m=r(!1),h=async()=>{try{f.value=!0,await g.get({query:{fieldby:"key",field:"notice"}}).then(s=>{if(s!=null&&s.value){const l=V(t);for(const a in l)t[a]=s.value[a]||t[a]}m.value=!0})}finally{f.value=!1}},q=async()=>{try{d.value=!0,await g.update({query:{fieldby:"key",field:"notice"},body:{value:V(t),key:"notice",_upsert:!0}}).then(()=>{E.success("保存成功")})}finally{d.value=!1}};return G(()=>p.theme,()=>{y.value.reload(),k.value.reload()}),I(()=>{h()}),(s,l)=>(v(),K("div",L,[o(e(A),{activeKey:b.value,"onUpdate:activeKey":l[8]||(l[8]=a=>b.value=a)},{default:u(()=>[o(e(S),{key:"notice",tab:"公告"},{default:u(()=>[w("div",M,[o(e(C),{spinning:f.value},{default:u(()=>[o(e(N),{ref_key:"formRef",ref:U,model:t,labelAlign:"left","label-col":{span:c.label}},{default:u(()=>[o(e(n),{label:"跑马灯公告"},{default:u(()=>[m.value?(v(),x(_,{key:0,ref_key:"marqueeRef",ref:k,id:"marqueeEditor",modelValue:t.marquee,"onUpdate:modelValue":l[0]||(l[0]=a=>t.marquee=a),dark:e(p).theme==="dark",options:{inline:!0}},null,8,["modelValue","dark"])):T("",!0)]),_:1}),z,o(e(n),{label:"弹窗公告标题",name:"title"},{default:u(()=>[o(e(i),{value:t.title,"onUpdate:value":l[1]||(l[1]=a=>t.title=a)},null,8,["value"])]),_:1}),o(e(n),{label:"弹窗公告内容"},{default:u(()=>[m.value?(v(),x(_,{key:0,ref_key:"editorRef",ref:y,id:"noticeEditor",modelValue:t.content,"onUpdate:modelValue":l[2]||(l[2]=a=>t.content=a),dark:e(p).theme==="dark",options:{inline:!0}},null,8,["modelValue","dark"])):T("",!0)]),_:1}),o(e(n),{label:"APP下载地址",name:"appurl"},{default:u(()=>[o(e(i),{value:t.appurl,"onUpdate:value":l[3]||(l[3]=a=>t.appurl=a),placeholder:"https://"},null,8,["value"])]),_:1}),o(e(n),{label:"APP下载按钮文字",name:"appText"},{default:u(()=>[o(e(i),{value:t.appText,"onUpdate:value":l[4]||(l[4]=a=>t.appText=a)},null,8,["value"])]),_:1}),o(e(n),{label:"发布地址",name:"publishurl"},{default:u(()=>[o(e(i),{value:t.publishurl,"onUpdate:value":l[5]||(l[5]=a=>t.publishurl=a),placeholder:"https://"},null,8,["value"])]),_:1}),o(e(n),{label:"发布地址按钮文字",name:"publishText"},{default:u(()=>[o(e(i),{value:t.publishText,"onUpdate:value":l[6]||(l[6]=a=>t.publishText=a)},null,8,["value"])]),_:1}),o(e(n),{wrapperCol:{offset:c.label}},{default:u(()=>[o(e(B),{size:"middle"},{default:u(()=>[o(e(P),{type:"primary",loading:d.value,onClick:l[7]||(l[7]=a=>q())},{default:u(()=>[$("保存")]),_:1},8,["loading"])]),_:1})]),_:1},8,["wrapperCol"])]),_:1},8,["model","label-col"])]),_:1},8,["spinning"])])]),_:1})]),_:1},8,["activeKey"])]))}};export{ee as default};
