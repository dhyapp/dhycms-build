import{a as E,g as I}from"./user-COF2e92G.js";import{c as O,ae as S,r as U,f,o as z,W as B,X as r,u as e,a1 as V,k as s,$ as a,V as g,Z as b,G as h,J as q}from"./vue-DoSrNxHp.js";import{l as G}from"./logox-BX9_wdrp.js";import{u as x}from"./coms-BJ4SXf9r.js";import{F as d,I as v,U as L,L as P,E as $,q as j,d as D,r as F,C as N,e as T}from"./ant2-F-VMf9eP.js";import{aA as w,bG as R}from"./ant1-FgANxHEo.js";const A={class:"adm-login-page f fc ac jc"},J={class:"wrapper"},M={class:"logo txtc"},W=["src"],X={class:"txtc"},Z={class:"f jb ac mb20 extra"},H=r("span",{class:"forget-btn"},"忘记密码?",-1),K=r("div",{class:"mt30 copyright"},"©2023 本程序由 comic.com 提供技术支持",-1),Q={async asyncData({ctx:_,store:i}){const n=x(i);n.preadmin=_.state.preadmin}},re=Object.assign(Q,{__name:"login",setup(_){const i=x(),n=O(()=>i.siteinfo),C=S(),o=U({username:"",password:"",code:"",rememberme:!0}),u=f(!1),y=f(null),m=f(!1),k=async()=>{y.value.src=`/api/v1/captcha?${Date.now()}`},c=async()=>{try{m.value=!0;const p=await E(q(o));p.ok&&(i.user=p.userInfo,R.success("登录成功"),C.push(`/${i.preadmin}`),I())}finally{m.value=!1}};return z(()=>{k()}),(p,t)=>(g(),B("div",A,[r("div",J,[r("div",M,[r("img",{src:e(G)},null,8,W)]),r("h1",X,"后台管理登录"+V(n.value.shortTitle||n.value.title?`-${n.value.shortTitle||n.value.title}`:""),1),s(e(T),{model:o,class:"mt30"},{default:a(()=>[s(e(d),{name:"username",rules:[{required:!0,message:"用户名不能为空"}],onPressEnter:c},{default:a(()=>[s(e(v),{value:o.username,"onUpdate:value":t[0]||(t[0]=l=>o.username=l),placeholder:"用户名/邮箱",size:"large"},{prefix:a(()=>[s(e(L))]),_:1},8,["value"])]),_:1}),s(e(d),{name:"password",rules:[{required:!0,message:"密码不能为空"}]},{default:a(()=>[s(e(v),{value:o.password,"onUpdate:value":t[3]||(t[3]=l=>o.password=l),type:u.value?"text":"password",placeholder:"密码",size:"large",onPressEnter:c},{prefix:a(()=>[s(e(P))]),suffix:a(()=>[u.value?(g(),b(e($),{key:0,class:"pwd-eye",onClick:t[1]||(t[1]=()=>u.value=!1)})):(g(),b(e(j),{key:1,class:"pwd-eye",onClick:t[2]||(t[2]=()=>u.value=!0)}))]),_:1},8,["value","type"])]),_:1}),s(e(d),{name:"code",rules:[{required:!0,message:"验证码不能为空"}]},{default:a(()=>[s(e(D),{compact:""},{default:a(()=>[s(e(v),{value:o.code,"onUpdate:value":t[4]||(t[4]=l=>o.code=l),placeholder:"验证码",size:"large",onPressEnter:c},{prefix:a(()=>[s(e(F))]),_:1},8,["value"]),s(e(w),{size:"large",onClick:k,class:"captcha-btn"},{default:a(()=>[r("img",{ref_key:"captcha",ref:y},null,512)]),_:1})]),_:1})]),_:1}),r("div",Z,[s(e(N),{checked:o.rememberme,"onUpdate:checked":t[5]||(t[5]=l=>o.rememberme=l)},{default:a(()=>[h("记住我")]),_:1},8,["checked"]),H]),s(e(d),{class:"mb0"},{default:a(()=>[s(e(w),{block:"",size:"large",type:"primary",loading:m.value,onClick:c},{default:a(()=>[h("登录")]),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),K]))}});export{re as default};
