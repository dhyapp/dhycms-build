import{_ as A}from"./cloud-poster-upload-DoFHsbIw.js";import{_ as H}from"./admin-form-action-bar-CaxKRg0f.js";import{a as B,m as O}from"./index-fks0TXNb.js";import{a4 as P,ae as j,c as z,f as m,r as E,o as J,a6 as D,W as g,k as e,$ as t,u as a,X as v,F as w,J as I,V as p,G as u,a1 as f,a7 as V,Z as Q}from"./vue-DoSrNxHp.js";import{u as W,t as X}from"./coms-BJ4SXf9r.js";import{bP as k,bQ as Z,aA as K,bN as R,bO as T,bD as h,bG as ee}from"./ant1-FgANxHEo.js";import{e as ae,F as r,I as q,j as te,f as le,s as oe,t as U,R as se}from"./ant2-F-VMf9eP.js";import"./modal-HJgcDYUy.js";import"./main-DsqflK1t.js";import"./index-DMU2ysKL.js";const ne={class:"f ac"},ue={class:"pannel nav-edit-page"},re=v("div",{class:"phead"},"广告编辑",-1),de={class:"form-max pt20 pr20 pb30 pl30"},ke={__name:"edit",setup(ie){const d=P(),F=j(),N=W(),x=z(()=>N.preadmin),S={label:4,wrapper:18},M=m(null),s=E({name:"",poster:"",link:"",type:"banner",position:"",text:"",mode:"",prepay:"",price:"",ontime:[],startTime:0,offTime:0,status:"auto"}),C={cpt:"时长付费"},b=m(!1),_=m(!1),$=m([]),G=async n=>{try{b.value=!0,await B.get({id:n}).then(l=>{const y=I(s);for(const i in y)s[i]=l[i]||s[i]})}finally{b.value=!1}},L=async()=>{const n={sortby:"sort",fieldby:"type,subType",field:"main,ad",pageSize:1e3};await O.list({query:n}).then(l=>{$.value=X({data:l.list})})},Y=async()=>{try{_.value=!0,await M.value.validate();const n={body:I(s)};d.params.id&&(n.id=d.params.id),n.body.ontime.length&&(n.body.startTime=new Date(n.body.ontime[0]).getTime(),n.body.offTime=new Date(n.body.ontime[1]).getTime());const l=!d.params.id;await B[l?"add":"update"](n).then(()=>{ee.success(`${l?"添加":"保存"}成功`),F.back()})}finally{_.value=!1}};return J(()=>{d.params.id&&G(d.params.id),L()}),(n,l)=>{const y=D("MIcon"),i=D("RouterLink");return p(),g(w,null,[e(a(Z),null,{default:t(()=>[e(a(k),null,{default:t(()=>[e(i,{to:`/${x.value}`},{default:t(()=>[e(y,{name:"dashboard",class:"mr6"}),u("控制台")]),_:1},8,["to"])]),_:1}),e(a(k),null,{default:t(()=>[e(i,{to:`/${x.value}/ads`},{default:t(()=>[u("广告管理")]),_:1},8,["to"])]),_:1}),e(a(k),null,{default:t(()=>[u("编辑")]),_:1})]),_:1}),e(H,{class:"mt14"},{default:t(()=>[v("div",ne,[e(a(K),{type:"primary",loading:_.value,onClick:l[0]||(l[0]=o=>Y())},{default:t(()=>[u(f(a(d).params.id?"保存修改":"添加"),1)]),_:1},8,["loading"])])]),_:1}),v("div",ue,[re,v("div",de,[e(a(h),{spinning:b.value},{default:t(()=>[e(a(ae),{ref_key:"formRef",ref:M,model:s,labelAlign:"left","label-col":{span:S.label},"wrapper-col":{span:S.wrapper}},{default:t(()=>[e(a(r),{label:"广告图"},{default:t(()=>[e(A,{mode:"whole",text:"上传广告图",modelValue:s.imgurl,"onUpdate:modelValue":l[1]||(l[1]=o=>s.imgurl=o)},null,8,["modelValue"])]),_:1}),e(a(r),{label:"广告类型",name:"type",rules:[{required:!0,message:"广告类型不能为空"}]},{default:t(()=>[e(a(R),{value:s.type,"onUpdate:value":l[2]||(l[2]=o=>s.type=o)},{default:t(()=>[e(a(T),{value:"banner"},{default:t(()=>[u("首页横幅")]),_:1})]),_:1},8,["value"])]),_:1}),e(a(r),{label:"广告位",name:"position",rules:[{required:!0,message:"广告位不能为空"}]},{default:t(()=>[e(a(R),{value:s.position,"onUpdate:value":l[3]||(l[3]=o=>s.position=o)},{default:t(()=>[(p(!0),g(w,null,V($.value,o=>(p(),Q(a(T),{key:o._id,value:o._id},{default:t(()=>[u(f(o.name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1}),e(a(r),{label:"名称",name:"name",rules:[{required:!0,message:"名称不能为空"}]},{default:t(()=>[e(a(q),{value:s.name,"onUpdate:value":l[4]||(l[4]=o=>s.name=o)},null,8,["value"])]),_:1}),e(a(r),{label:"跳转链接",name:"link",rules:[{required:!0,message:"跳转链接不能为空"}]},{default:t(()=>[e(a(q),{value:s.link,"onUpdate:value":l[5]||(l[5]=o=>s.link=o),placeholder:"https://"},null,8,["value"])]),_:1}),e(a(r),{label:"广告文案"},{default:t(()=>[e(a(te),{value:s.text,"onUpdate:value":l[6]||(l[6]=o=>s.text=o)},null,8,["value"])]),_:1}),e(a(r),{label:"计费模式",name:"mode"},{default:t(()=>[e(a(R),{value:s.mode,"onUpdate:value":l[7]||(l[7]=o=>s.mode=o)},{default:t(()=>[(p(),g(w,null,V(C,(o,c)=>e(a(T),{key:c,value:c},{default:t(()=>[u(f(o)+"（"+f(c.toUpperCase())+"）",1)]),_:2},1032,["value"])),64))]),_:1},8,["value"])]),_:1}),e(a(r),{label:"预付款",name:"prepay"},{default:t(()=>[e(a(le),{value:s.prepay,"onUpdate:value":l[8]||(l[8]=o=>s.prepay=o),style:{width:"100%"},min:0},null,8,["value"])]),_:1}),e(a(r),{label:"上下线",name:"status"},{default:t(()=>[e(a(oe),{value:s.status,"onUpdate:value":l[9]||(l[9]=o=>s.status=o)},{default:t(()=>[e(a(U),{value:"auto"},{default:t(()=>[u("自动")]),_:1}),e(a(U),{value:"on"},{default:t(()=>[u("上线")]),_:1}),e(a(U),{value:"off"},{default:t(()=>[u("下线")]),_:1})]),_:1},8,["value"])]),_:1}),e(a(r),{label:"上线时间",name:"ontime"},{default:t(()=>[e(a(se),{value:s.ontime,"onUpdate:value":l[10]||(l[10]=o=>s.ontime=o),placeholder:["上线时间","下线时间"],valueFormat:"YYYY-MM-DD HH:mm:ss",showTime:"",showNow:""},null,8,["value"])]),_:1})]),_:1},8,["model","label-col","wrapper-col"])]),_:1},8,["spinning"])])])],64)}}};export{ke as default};
