import a from"../config.mjs";import t from"crypto-js";import m from"crypto";const{secret:d}=a,n=(r,o)=>{typeof r=="object"&&(r=JSON.stringify(r));let e=m.createHash("md5");return e.update(r),e.digest("hex")},f=(r,o,e)=>{const s=n(o||d,1),c=t.enc.Utf8.parse(s.substring(0,16));return e=e||t.enc.Utf8.parse(s.substring(16,32)),t.AES.encrypt(r,c,{vi:e,mode:t.mode.ECB,padding:t.pad.Pkcs7}).toString()},i=(r,o,e)=>{const s=n(o||d,1),c=t.enc.Utf8.parse(s.substring(0,16));return e=e||t.enc.Utf8.parse(s.substring(16,32)),t.AES.decrypt(r,c,{vi:e,mode:t.mode.ECB,padding:t.pad.Pkcs7}).toString(t.enc.Utf8).toString()};var S={md5:n,aesEncode:f,aesDecode:i};export{i as aesDecode,f as aesEncode,S as default,n as md5};
